# å †å’Œå †æ’åº

## ç®€è¨€

* å †æ’åºå’Œå¿«é€Ÿçš„æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ `O(nlogn)`. ä½†åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œå¿«é€Ÿæ’åºçš„æ€§èƒ½ä¼šæ¯”å †æ’åºå¥½ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
* æœ¬èŠ‚ä¸»è¦å…³æ³¨å †è¿™ç§æ•°æ®ç»“æ„å’Œå †æ’åºçš„å®ç°ã€‚

> å­¦ä¹ æ›²çº¿ï¼šâ˜…â˜…â˜…â˜†

## å¦‚ä½•ç†è§£å †

### å †çš„å®šä¹‰

* **å †æ˜¯å®Œå…¨äºŒå‰æ ‘ã€‚**
	* é™¤äº†æœ€åä¸€å±‚ï¼Œå…¶ä»–å±‚çš„èŠ‚ç‚¹ä¸ªæ•°éƒ½æ˜¯æ»¡çš„ï¼Œè€Œæœ€åä¸€å±‚çš„èŠ‚ç‚¹é å·¦æ’åˆ—ã€‚
* **å †ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹å€¼å¿…é¡»å¤§äºç­‰äºï¼ˆæˆ–å°äºç­‰äºï¼‰å½“å‰èŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹çš„å€¼ã€‚**
	* å †ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹çš„å€¼å¿…é¡»å¤§äºç­‰äºï¼ˆæˆ–å°äºç­‰äºï¼‰å…¶å­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚
	* **å¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼çš„å †ï¼Œç§°ä¸ºå¤§é¡¶å †ï¼›åä¹‹ç§°ä¹‹ä¸ºå°é¡¶å †ã€‚**
* è§‚å¯Ÿä¸‹é¢çš„æ ‘ï¼Œåˆ¤æ–­è¿™äº›æ ‘æ˜¯å¦æ˜¯å †ã€‚

![[å †çš„ç¤ºæ„å›¾.png]]

* ä¸Šå›¾å››ä¸ªæ ‘åˆ†åˆ«æ˜¯ï¼šå¤§é¡¶å †ï¼Œå¤§é¡¶å †ï¼Œå°é¡¶å †ï¼Œä¸æ˜¯å †ã€‚
* å…¶å®å¯¹äºåŒä¸€ç»„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å½¢æˆä¸åŒçš„å †ã€‚

### å¦‚ä½•å®ç°ä¸€ä¸ªå †ï¼Ÿ

* äº†è§£å¦‚ä½•å®ç°å †ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£å¦‚ä½•æ¥å­˜å‚¨å †è¿™ç§æ•°æ®ç»“æ„ã€‚

#### å¦‚ä½•å­˜å‚¨å †

* å‰é¢çš„ç« èŠ‚æåˆ°è¿‡ï¼Œ**å®Œå…¨äºŒå‰æ ‘é€‚åˆç”¨æ•°ç»„æ¥å­˜å‚¨**ï¼Œå› ä¸ºä¸éœ€è¦å­˜å‚¨å·¦å³å­èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚ä»…é€šè¿‡ä¸‹æ ‡ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹ã€‚
* ä¸‹é¢å°±æ˜¯ç”¨æ•°ç»„æ¥å­˜å‚¨ä¸€ä¸ªå †çš„ç¤ºä¾‹ã€‚

![[å †çš„å­˜å‚¨.png]]

* ä»å›¾ä¸­å¯ä»¥å‘ç°ï¼Œä¸‹æ ‡ i çš„å·¦å­èŠ‚ç‚¹å°±æ˜¯ä¸‹æ ‡ä¸º `2 * i` çš„èŠ‚ç‚¹ï¼›ä¸‹æ ‡ i çš„å³å­èŠ‚ç‚¹å°±æ˜¯ä¸‹æ ‡ä¸º `2 * i + 1` çš„èŠ‚ç‚¹ã€‚
* çˆ¶èŠ‚ç‚¹å°±æ˜¯ä¸‹æ ‡ä¸º `Math.floor(i / 2)` çš„èŠ‚ç‚¹ã€‚

### å †çš„æ ¸å¿ƒæ“ä½œ

* å †çš„æ ¸å¿ƒæ“ä½œè¿™é‡Œä¸»è¦ä»‹ç»ä¸¤ç§ï¼š
	* å¾€å †ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼›
	* åˆ é™¤å †é¡¶å…ƒç´ ã€‚

#### 1. å¾€å †ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ 

* å¾€å †ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ åï¼Œéœ€è¦ç»§ç»­æ»¡è¶³å †çš„ä¸¤ä¸ªç‰¹æ€§ã€‚
* å¦‚æœç›´æ¥æŠŠæ–°æ’å…¥çš„å…ƒç´ æ”¾åˆ°å †çš„æœ«å°¾ï¼Œå¦‚ä¸‹å›¾ã€‚å°±ä¼šå¯¼è‡´åŸæ¥çš„å¤§é¡¶å †ä¸æ»¡è¶³æ¡ä»¶äº†ã€‚
* æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œè°ƒæ•´ï¼Œè¿™ä¸ªè°ƒæ•´çš„è¿‡ç¨‹ç§°ä¹‹ä¸º**å †åŒ–(heapify)**.

![[å †çš„æ’å…¥.png]]

* å †åŒ–å®é™…ä¸Šæœ‰ä¸¤ç§ï¼Œ**ä»ä¸‹å¾€ä¸Šå’Œä»ä¸Šå¾€ä¸‹**ã€‚è¿™é‡Œå…ˆä»‹ç»ä»ä¸‹å¾€ä¸Šçš„å †åŒ–æ–¹æ³•ã€‚
* **å †åŒ–çš„æœ¬è´¨æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é¡ºç€èŠ‚ç‚¹çš„è·¯å¾„ï¼Œå‘ä¸Šæˆ–è€…å‘ä¸‹æ¯”è¾ƒèŠ‚ç‚¹å€¼çš„å¤§å°ï¼Œç„¶åè¿›è¡Œäº¤æ¢ã€‚**
* ä¸¤ç§å †åŒ–çš„å®šä¹‰ï¼š
	* **è‡ªä¸‹è€Œä¸Šå †åŒ–ï¼šå°†èŠ‚ç‚¹ä¸å…¶çˆ¶èŠ‚ç‚¹æ¯”è¾ƒï¼Œå¦‚æœèŠ‚ç‚¹å¤§äºçˆ¶èŠ‚ç‚¹ï¼ˆå¤§é¡¶å †ï¼‰æˆ–è€…èŠ‚ç‚¹å°äºçˆ¶èŠ‚ç‚¹ï¼ˆå°é¡¶å †ï¼‰ï¼Œåˆ™èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹äº¤æ¢ä½ç½®ã€‚**
	* **è‡ªä¸Šè€Œä¸‹å †åŒ–ï¼šå°†èŠ‚ç‚¹ä¸å…¶å·¦å³å­èŠ‚ç‚¹æ¯”è¾ƒï¼Œå¦‚æœå­˜åœ¨å·¦å³å­èŠ‚ç‚¹å¤§äºå½“å‰èŠ‚ç‚¹ï¼ˆå¤§é¡¶å †ï¼‰æˆ–å·¦å³å­èŠ‚ç‚¹å°äºå½“å‰èŠ‚ç‚¹ï¼ˆå°é¡¶å †ï¼‰ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹çš„æœ€å¤§å€¼ï¼ˆå¤§é¡¶å †ï¼‰æˆ–æœ€å°å€¼ï¼ˆå°é¡¶å †ï¼‰ä¸å½“å‰èŠ‚ç‚¹äº¤æ¢ä½ç½®ã€‚**
* ä¸‹é¢æ˜¯å †åŒ–çš„åˆ†è§£å›¾ï¼Œ*è®©æ–°æ’å…¥çš„èŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹æ¯”è¾ƒå¤§å°ï¼Œå¦‚æœä¸æ»¡è¶³å­èŠ‚ç‚¹å°äºç­‰äºçˆ¶èŠ‚ç‚¹å€¼çš„å¤§å°å…³ç³»ï¼Œå°±äº’æ¢è¿™ä¸¤ä¸ªèŠ‚ç‚¹ã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°çˆ¶å­èŠ‚ç‚¹ä¹‹é—´æ»¡è¶³å¤§å°å…³ç³»ã€‚*

![[å †åŒ–ç¤ºæ„å›¾.png]]

* å¯ä»¥ç»“åˆç€ä»£ç æ¥ç†è§£ã€‚
* ä¸‹é¢æ˜¯ä¸¤ç§å †åŒ–çš„å®ç°ã€‚**ä»ä¸‹å¾€ä¸Š**å †åŒ–å½¢æˆå°é¡¶å †ï¼š

```typescript
/**
 * @description: ä»ä¸‹å¾€ä¸Šå †åŒ–ï¼Œäº¤æ¢å½“å‰èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹
 * è¿™é‡Œçš„æ–¹å‘æŒ‡çš„æ˜¯æ¯”è¾ƒçš„æ–¹å‘ï¼Œå°†å½“å‰èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒ
 * @param {number[]} arr
 * @param {number} i
 * @return {void}
 */
function heapify(arr: number[], i: number): void {
  while (Math.floor(i / 2) > 0 && arr[Math.floor(i / 2)] > arr[i]) {
    swap(arr, i, Math.floor(i / 2));
    i = Math.floor(i / 2);
  }
}
```

* è¿™æ˜¯**ä»ä¸Šå¾€ä¸‹**å †åŒ–çš„å®ç°ï¼Œæ„å»ºçš„æ˜¯å°é¡¶å †ã€‚

```typescript
/**
 * @description: è‡ªä¸Šå¾€ä¸‹çš„å †åŒ–ï¼Œäº¤æ¢å½“å‰èŠ‚ç‚¹å’Œå·¦å³å­èŠ‚ç‚¹ä¹‹ä¸€
 * è¿™é‡Œçš„æ–¹å‘æŒ‡çš„æ˜¯æ¯”è¾ƒçš„æ–¹å‘ï¼Œå°†å½“å‰èŠ‚ç‚¹ä¸å·¦å³å­èŠ‚ç‚¹æ¯”è¾ƒ
 * è¿™æ˜¯å †åŒ–å°é¡¶å †çš„å†™æ³•ï¼Œå¤§é¡¶å †ä¹Ÿç±»ä¼¼
 * @param {number[]} arr
 * @param {number} heapSize
 * @param {number} i
 * @return {void}
 */
function heapify(arr: number[], heapSize: number, i: number): void {
  let minIndex = i;
  
  while (true) {
    // ä¸‹é¢ä¸¤ä¸ªåˆ¤æ–­æ‰¾å‡ºå·¦å³å­èŠ‚ç‚¹ä¸­çš„è¾ƒå°å€¼ï¼Œå°†å…¶ä¸å½“å‰èŠ‚ç‚¹äº¤æ¢
    if (2 * i <= heapSize && arr[minIndex] > arr[2 * i]) minIndex = 2 * i;
    if ((2 * i + 1) <= heapSize && arr[minIndex] > arr[2 * i +1]) minIndex = 2 * i + 1;
    // ç›¸ç­‰æ—¶è¯´æ˜å·²ç»å †åŒ–åˆ°äº†æœ€å
    if (minIndex === i) break;
    swap(arr, i, minIndex);
    i = minIndex;
  }
}
```

* ä¸‹é¢æ˜¯å †çš„ TS çš„ç®€å•å®ç°ï¼Œå«æ’å…¥æ“ä½œã€‚

```typescript
class Heap {
  private arr: any[]; // ä½¿ç”¨æ•°ç»„è¡¨ç¤ºå †
  private max: number; // å †å¯ä»¥å­˜å‚¨çš„æœ€å¤§æ•°é‡
  private count: number; // å †ä¸­å·²ç»å­˜åœ¨çš„æ•°æ®

  /**
   * @description: åˆå§‹åŒ–å † 
   * @param {number} capacity
   * @return {void}
   */
  constructor(capacity: number) {
    this.arr = new Array(capacity + 1);
    this.max = capacity;
    this.count = 0;
  }

  /**
   * @description: äº¤æ¢æ•°ç»„ä¸­å¯¹åº”ç´¢å¼•çš„ä½ç½®
   * @param {any[]} arr
   * @param {number} i
   * @param {number} j
   * @return {void}
   */
  private swap(arr: any[], i: number, j: number): void {
    [arr[j], arr[i]] = [arr[i], arr[j]];
  }

  /**
   * @description: è‡ªä¸‹å¾€ä¸Šå †åŒ–
   * @param {any} data
   * @return {boolean}
   */
  public insert(data: any): boolean {
    if (this.count > this.max) return false;
    this.count++;
    this.arr[this.count] = data;
    let i = this.count;

    // ç´¢å¼•ä»åå¾€å‰
    while (Math.floor(i / 2) > 0 && this.arr[i] > this.arr[Math.floor(i / 2)]) {
      // äº¤æ¢ä½ç½®
      this.swap(this.arr, i, Math.floor(i/2));
      i /= 2;
      i = Math.floor(i);
    }

    return true;
  }
}

const heap = new Heap(8);
heap.insert('hello world');
console.log('heap ===>', heap);
```

* åŸæ–‡ä¸­çš„ Java å®ç°ï¼Œä»¥ä¾›å‚è€ƒã€‚

```java
public class Heap {
  private int[] a; // æ•°ç»„ï¼Œä»ä¸‹æ ‡1å¼€å§‹å­˜å‚¨æ•°æ®
  private int n;  // å †å¯ä»¥å­˜å‚¨çš„æœ€å¤§æ•°æ®ä¸ªæ•°
  private int count; // å †ä¸­å·²ç»å­˜å‚¨çš„æ•°æ®ä¸ªæ•°

  public Heap(int capacity) {
    a = new int[capacity + 1];
    n = capacity;
    count = 0;
  }

  public void insert(int data) {
    if (count >= n) return; // å †æ»¡äº†
    ++count;
    a[count] = data;
    int i = count;
    while (i/2 > 0 && a[i] > a[i/2]) { // è‡ªä¸‹å¾€ä¸Šå †åŒ–
      swap(a, i, i/2); // swap()å‡½æ•°ä½œç”¨ï¼šäº¤æ¢ä¸‹æ ‡ä¸ºiå’Œi/2çš„ä¸¤ä¸ªå…ƒç´ 
      i = i/2;
    }
  }
 }
```

#### 2. åˆ é™¤å †é¡¶å…ƒç´ 

* ä»å †çš„å®šä¹‰ä¸­å¯ä»¥å‘ç°ï¼Œ**å †é¡¶å…ƒç´ å­˜å‚¨çš„å°±æ˜¯å †ä¸­æ•°æ®çš„æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼ã€‚** æ ¹æ®å¤§é¡¶å †æˆ–å°é¡¶å †è€Œè¡¨ç°ä¸åŒã€‚
* å‡è®¾æ„é€ ä¸€ä¸ªå¤§é¡¶å †ï¼Œå †é¡¶å…ƒç´ å°±æ˜¯æœ€å¤§çš„å…ƒç´ ã€‚å½“åˆ é™¤å †é¡¶å…ƒç´ ä¹‹åï¼Œå°±éœ€è¦æŠŠç¬¬äºŒå¤§çš„å…ƒç´ æ”¾åˆ°å †é¡¶ï¼Œé‚£ä¹ˆç¬¬äºŒå¤§å…ƒç´ è‚¯å®šä¼šå‡ºç°åœ¨å·¦å³å­èŠ‚ç‚¹ä¸­ã€‚ç„¶åå†ç»§ç»­è¿­ä»£åœ°åˆ é™¤ç¬¬äºŒå¤§èŠ‚ç‚¹ï¼Œä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°å¶å­èŠ‚ç‚¹åˆ é™¤ã€‚
* ä¸‹é¢æ˜¯è¿™ç§æ–¹æ³•çš„åˆ†è§£å›¾ï¼Œä½†è¿™ç§æ–¹æ³•ä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æœ€åå †åŒ–å‡ºæ¥çš„å †å¹¶ä¸æ»¡è¶³å®Œå…¨äºŒå‰æ ‘çš„ç‰¹æ€§ã€‚

![[åˆ é™¤å †é¡¶å…ƒç´ é”™è¯¯ç¤ºæ„å›¾.png]]

* å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç¨å¾®æ”¹å˜ä¸€ä¸‹æ€è·¯æ¥è§£å†³ã€‚
	* **åˆ é™¤å †é¡¶å…ƒç´ åï¼ŒæŠŠæœ€åä¸€ä¸ªèŠ‚ç‚¹æ”¾åˆ°å †é¡¶ï¼Œç„¶ååˆ©ç”¨åŒæ ·çš„çˆ¶å­èŠ‚ç‚¹å¯¹æ¯”æ–¹æ³•ï¼Œå¯¹äºä¸æ»¡è¶³çˆ¶å­èŠ‚ç‚¹å¤§å°å…³ç³»çš„ï¼Œäº’æ¢ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°çˆ¶å­èŠ‚ç‚¹ä¹‹é—´æ»¡è¶³å¤§å°å…³ç³»ä¸ºæ­¢ã€‚**
	* **è¿™å°±æ˜¯ä»ä¸Šå¾€ä¸‹çš„å †åŒ–æ–¹æ³•ã€‚**
* å› ä¸ºç§»é™¤çš„æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè€Œåœ¨å †åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œåˆéƒ½æ˜¯äº¤æ¢æ“ä½œï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°æ•°ç»„ä¸­çš„ç©ºæ´ï¼Œä¹Ÿå°±æ˜¯è¿™ç§æ–¹æ³•å †åŒ–ä¹‹åçš„ç»“æœä»ç„¶æ˜¯æ»¡è¶³äºŒå‰æ ‘çš„ç‰¹æ€§çš„ã€‚

![[åˆ é™¤å †é¡¶å…ƒç´ ç¤ºæ„å›¾.png]]

### å †çš„å®ç°

* ä¸‹é¢æ˜¯å«å †åŒ–å’Œåˆ é™¤å †é¡¶å…ƒç´ çš„å®Œæ•´çš„å †çš„å®ç°ï¼Œä¹Ÿæ¶µç›–äº†æ’å…¥æ“ä½œã€‚
	* åŒ…å«æ’å…¥å’Œåˆ é™¤çš„ç¤ºä¾‹æ“ä½œå’Œæ•ˆæœã€‚

```typescript
class Heap {
  private arr: any[]; // ä½¿ç”¨æ•°ç»„è¡¨ç¤ºå †
  private max: number; // å †å¯ä»¥å­˜å‚¨çš„æœ€å¤§æ•°é‡
  private count: number; // å †ä¸­å·²ç»å­˜åœ¨çš„æ•°æ®æ•°é‡

  /**
   * @description: åˆå§‹åŒ–å † 
   * @param {number} capacity
   * @return {void}
   */
  constructor(capacity: number) {
    this.arr = new Array(capacity + 1);
    this.max = capacity;
    this.count = 0;
  }

  /**
   * @description: äº¤æ¢æ•°ç»„ä¸­å¯¹åº”ç´¢å¼•çš„ä½ç½®
   * @param {any[]} arr
   * @param {number} i
   * @param {number} j
   * @return {void}
   */
  private swap(arr: any[], i: number, j: number): void {
    [arr[j], arr[i]] = [arr[i], arr[j]];
  }

  /**
   * @description: å †åŒ–
   * æŒ‰ç…§å¤§é¡¶å †çš„æ–¹å¼å †åŒ–
   * @param {number[]} arr
   * @param {number} heapSize
   * @param {number} i
   * @return {void}
   */
  private heapify(arr: number[], heapSize: number, i: number): void {
    let maxIndex = i;

    while (true) {
      // ä¿å­˜è¾ƒå¤§å€¼çš„ç´¢å¼•ï¼Œåˆ†åˆ«ä¸å·¦å³å­èŠ‚ç‚¹æ¯”è¾ƒ
      if (2 * i <= heapSize && arr[maxIndex] < arr[2 * i]) maxIndex = 2 * i;
      if ((2 * i + 1) <= heapSize && arr[maxIndex] < arr[2 * i + 1]) maxIndex = 2 * i + 1;
      if (maxIndex === i) break;
      this.swap(arr, i, maxIndex);
      i = maxIndex;
    }
  }

  /**
   * @description: æ’å…¥ä¸€ä¸ªå…ƒç´ 
   * è‡ªä¸‹å¾€ä¸Šå †åŒ–
   * @param {any} data
   * @return {boolean}
   */
  public insert(data: any): boolean {
    if (this.count > this.max) return false;
    this.count++;
    this.arr[this.count] = data;
    let i = this.count;

    // ç´¢å¼•ä»åå¾€å‰
    while (Math.floor(i / 2) > 0 && this.arr[i] > this.arr[Math.floor(i / 2)]) {
      // äº¤æ¢ä½ç½®
      this.swap(this.arr, i, Math.floor(i / 2));
      i /= 2;
      i = Math.floor(i);
    }

    return true;
  }

  /**
   * @description: åˆ é™¤å †é¡¶å…ƒç´ 
   * äº¤æ¢å †é¡¶å…ƒç´ åˆ°æœ«å°¾ï¼Œå†ä»ä¸Šå¾€ä¸‹è¿›è¡Œå †åŒ–
   * @return {void}
   */
  public removeMax() {
    // å½“å‰å †ä¸­æ²¡æœ‰æ•°æ®
    if (this.count === 0) return -1;
    // æŠŠæœ«å°¾å…ƒç´ äº¤æ¢åˆ°å †é¡¶ç‚¹
    this.arr[1] = this.arr[this.count];
    this.arr.pop(); // åˆ©ç”¨ js çš„æ–¹æ³•ç›´æ¥å‰”é™¤æœ€åä¸€ä¸ªå…ƒç´ 
    // å‰”é™¤æœ€åä¸€ä¸ªèŠ‚ç‚¹
    this.count--;
    // è‡ªä¸Šå¾€ä¸‹å †åŒ–
    this.heapify(this.arr, this.count, 1);
  }
}

// å»ºç«‹ä¸€ä¸ªæœ‰ç€å››ä¸ªå…ƒç´ çš„å †ï¼Œåˆ†åˆ«æ’å…¥å››ä¸ªå…ƒç´ ï¼Œå†åˆ é™¤å †é¡¶å…ƒç´ ï¼Œè§‚å¯Ÿå…¶å˜åŒ–
const heap = new Heap(4);
heap.insert(4);
heap.insert(7);
heap.insert(2);
heap.insert(3);
console.log('heap before deleting ==>', heap);
heap.removeMax();
console.log('heap after deleting ==>', heap);
```

* è¿™æ˜¯åˆ é™¤è¿‡ç¨‹çš„ Java ä»£ç ç‰‡æ®µï¼Œä»¥ä¾›å‚è€ƒã€‚

```java
public void removeMax() {
  if (count == 0) return -1; // å †ä¸­æ²¡æœ‰æ•°æ®
  a[1] = a[count];
  --count;
  heapify(a, count, 1);
}

private void heapify(int[] a, int n, int i) { // è‡ªä¸Šå¾€ä¸‹å †åŒ–
  while (true) {
    int maxPos = i;
    if (i*2 <= n && a[i] < a[i*2]) maxPos = i*2;
    if (i*2+1 <= n && a[maxPos] < a[i*2+1]) maxPos = i*2+1;
    if (maxPos == i) break;
    swap(a, i, maxPos);
    i = maxPos;
  }
}
```

* ç”±ä¹‹å‰çš„å­¦ä¹ æ‰€çŸ¥ï¼Œä¸€ä¸ªåŒ…å« n ä¸ªèŠ‚ç‚¹çš„å®Œå…¨äºŒå‰æ ‘ï¼Œæ ‘çš„é«˜åº¦ä¸ä¼šè¶…è¿‡ `logâ‚‚n`ã€‚å †åŒ–çš„è¿‡ç¨‹æ˜¯æ²¿ç€èŠ‚ç‚¹æ‰€åœ¨è·¯å¾„è¿›è¡Œæ¯”è¾ƒäº¤æ¢çš„ï¼Œæ‰€ä»¥å †åŒ–çš„æ—¶é—´å¤æ‚åº¦å°±å’Œæ ‘çš„å¤æ‚åº¦æˆæ­£æ¯”ï¼Œä¹Ÿå°±æ˜¯ `O(logn)`.
* **æ’å…¥æ•°æ®å’Œåˆ é™¤å †é¡¶å…ƒç´ çš„ä¸»è¦é€»è¾‘å°±æ˜¯å †åŒ–ï¼Œæ‰€ä»¥æ’å…¥ä¸€ä¸ªå…ƒç´ å’Œåˆ é™¤å †é¡¶å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ `O(logn)`.**

### å¦‚ä½•åŸºäºå †å®ç°æ’åº

* å‰é¢çš„ç« èŠ‚æåˆ°è¿‡å¾ˆå¤šç§ç®—æ³•ï¼Œæœ‰æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n^2)` çš„å†’æ³¡æ’åºã€æ’å…¥æ’åºã€é€‰æ‹©æ’åºï¼Œä¹Ÿæœ‰æ—¶é—´å¤æ‚åº¦æ˜¯ `O(nlogn)` çš„å½’å¹¶æ’åºã€å¿«é€Ÿæ’åºå’Œçº¿æ€§æ’åºç­‰ã€‚
* ç°åœ¨æˆ‘ä»¬å€ŸåŠ©å †è¿™ç§æ•°æ®ç»“æ„å®ç°çš„ç®—æ³•ï¼Œå°±æ˜¯å †æ’åºã€‚è¿™ç§æ’åºæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ¯”è¾ƒç¨³å®šï¼Œå°±æ˜¯ `O(nlogn)`. è€Œä¸”å®ƒæ˜¯åŸåœ°æ’åºç®—æ³•ã€‚
* å¯ä»¥æŠŠå †æ’åºçš„è¿‡ç¨‹å¤§è‡´åˆ†è§£æˆä¸¤ä¸ªå¤§æ­¥éª¤ï¼Œ**å»ºå †å’Œæ’åº**ã€‚

#### å»ºå †

* é¦–å…ˆæ˜¯æŠŠæ•°ç»„åŸåœ°å»ºæˆä¸€ä¸ªå †ã€‚åŸåœ°çš„æ„æ€å°±æ˜¯ä¸å€ŸåŠ©å¤–éƒ¨æ•°æ®ï¼Œç›´æ¥åœ¨åŸæ•°ç»„ä¸Šæ“ä½œã€‚å»ºå †çš„è¿‡ç¨‹ä¹Ÿæœ‰ä¸¤ç§æ€è·¯ã€‚
* ç¬¬ä¸€ç§æ˜¯å€ŸåŠ©å‰é¢è®²çš„åœ¨å †ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ çš„æ€è·¯ã€‚å°½ç®¡ç°åœ¨çš„æ•°ç»„ä¸­åŒ…å« n ä¸ªæ•°æ®ï¼Œä½†æ˜¯å¯ä»¥å‡è®¾èµ·åˆå †ä¸­åªåŒ…å«ä¸€ä¸ªæ•°æ®å°±æ˜¯ä¸‹æ ‡ä¸º 1 çš„æ•°æ®ã€‚å†è°ƒç”¨æ’å…¥æ“ä½œï¼ŒæŠŠä¸‹æ ‡ä» 2 åˆ° n çš„æ•°æ®ä¾æ¬¡æ’å…¥åˆ°å †ä¸­ã€‚è¿™æ ·å°±æŠŠåŒ…å«äº† n ä¸ªæ•°æ®çš„æ•°æ®ç»„ç»‡æˆäº†å †ã€‚
	* **è‡ªä¸‹è€Œä¸Šå †åŒ–**
* ç¬¬äºŒç§å®ç°æ€è·¯å’Œç¬¬ä¸€ç§ç›¸åã€‚ç¬¬ä¸€ç§å»ºå †æ€è·¯æ˜¯ä»å‰å¾€åå¤„ç†æ•°ç»„æ•°æ®ï¼Œå¹¶ä¸”æ¯ä¸ªæ•°æ®æ’å…¥å †ä¸­æ—¶ï¼Œéƒ½æ˜¯ä»ä¸‹å¾€ä¸Šå †åŒ–ã€‚ç¬¬äºŒç§å®ç°æ€è·¯å°±æ˜¯ä»åå¾€å‰å¤„ç†æ•°ç»„ï¼Œå¹¶ä¸”æ¯ä¸ªæ•°æ®æ˜¯ä»ä¸Šå¾€ä¸‹å †åŒ–çš„ã€‚
	* **è‡ªä¸Šè€Œä¸‹å †åŒ–**
* ä¸‹é¢æ˜¯ç¬¬äºŒç§å®ç°æ€è·¯çš„è¿‡ç¨‹ï¼Œå»ºå †åˆ†è§£æ­¥éª¤å›¾ã€‚
	* å› ä¸ºå¶å­èŠ‚ç‚¹å¾€ä¸‹å †åŒ–åªèƒ½å’Œè‡ªå·±æ¯”è¾ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡å †åŒ–å³å¯ã€‚

![[å»ºå †ç¤ºæ„å›¾ä¸€.png]]
![[å»ºå †ç¤ºæ„å›¾äºŒ.png]]

#### è‡ªä¸‹è€Œä¸Šå †åŒ–æ„å»ºå°é¡¶å †

* ç¬¬ä¸€ç§å»ºå †è¿‡ç¨‹åŠåº”ç”¨ï¼Œè¿™é‡Œå»ºå †çš„æ˜¯å°é¡¶å †ï¼Œä»å‰å¾€åï¼Œå †åŒ–æ²¿ç”¨ä¸Šæ–‡ä¸­çš„ä»ä¸‹åˆ°ä¸Šçš„æ–¹å¼ï¼š

```typescript
/**
 * @description: å»ºå †
 * ä»å‰å¾€åæ„å»ºå †
 * @param {number[]} arr
 * @param {number} heapSize
 * @return {void}
 */
function buildHeap(arr: number[], heapSize: number): void {
  while(heapSize < arr.length - 1) {
    heapSize++;
    heapify(arr, heapSize);
  }
}

const items = [undefined, 5, 2, 3, 4, 1];
// åˆå§‹æœ‰æ•ˆåºåˆ—é•¿åº¦ä¸º 1
buildHeap(items, 1);
console.log(items);
```

##### è‡ªä¸Šè€Œä¸‹å †åŒ–æ„å»ºå¤§é¡¶å †

* ä¸‹é¢æ˜¯ç¬¬äºŒç§å®ç°çš„ TS ä»£ç ï¼Œä»åå¾€å‰å»ºå †ï¼Œä»ä¸Šå¾€ä¸‹å †åŒ–ã€‚

```typescript
/**
 * @description: å †åŒ–
 * æŒ‰ç…§å¤§é¡¶å †çš„æ–¹å¼å †åŒ–
 * @param {number[]} arr
 * @param {number} heapSize
 * @param {number} i
 * @return {void}
 */
function heapify(arr: number[], heapSize: number, i: number): void {
  let maxIndex = i;

  while (true) {
    // ä¿å­˜è¾ƒå¤§å€¼çš„ç´¢å¼•ï¼Œåˆ†åˆ«ä¸å·¦å³å­èŠ‚ç‚¹æ¯”è¾ƒ
    if (2 * i <= heapSize && arr[maxIndex] < arr[2 * i]) maxIndex = 2 * i;
    if ((2 * i + 1) <= heapSize && arr[maxIndex] < arr[2 * i + 1]) maxIndex = 2 * i + 1;
    if (maxIndex === i) break;
    swap(arr, i, maxIndex);
    i = maxIndex;
  }
}

/**
 * @description: å»ºå †
 * è¿™é‡Œä»åå¾€å‰å»ºç«‹å¤§é¡¶å †
 * @param {number[]} arr
 * @param {number} heapSize
 * @return {void}
 */
function buildHeap(arr: number[], heapSize: number): void {
  // ä»åå¾€å‰ä»æœ€åçš„éå¶å­èŠ‚ç‚¹å¼€å§‹
  for (let i = Math.floor(heapSize / 2); i > 0; i--) {
    heapify(arr, heapSize, i);
  }
}

// éªŒè¯æ„å»ºæ•ˆæœ
const items = [undefined, 1, 2, 3, 4, 5];
// åˆå§‹æœ‰æ•ˆåºåˆ—é•¿åº¦ä¸º 1
buildHeap(items, items.length - 1);
console.log(items);
```

* åŸæ–‡ä¸­çš„ Java ä»£ç ï¼Œæ˜¯ç¬¬äºŒç§ï¼Œä»¥ä¾›å‚è€ƒã€‚

```java
private static void buildHeap(int[] a, int n) {
  for (int i = n/2; i >= 1; --i) {
    heapify(a, n, i);
  }
}

private static void heapify(int[] a, int n, int i) {
  while (true) {
    int maxPos = i;
    if (i*2 <= n && a[i] < a[i*2]) maxPos = i*2;
    if (i*2+1 <= n && a[maxPos] < a[i*2+1]) maxPos = i*2+1;
    if (maxPos == i) break;
    swap(a, i, maxPos);
    i = maxPos;
  }
}
```

* ä»ä»£ç ä¸­å¯ä»¥å‘ç°ï¼Œåªéœ€è¦å¯¹ 1 åˆ° `n / 2` çš„èŠ‚ç‚¹è¿›è¡Œå †åŒ–ã€‚å‰©ä¸‹çš„èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ï¼Œä¸éœ€è¦å †åŒ–ã€‚
	* å®é™…ä¸Šåœ¨å®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œä¸‹æ ‡ `n / 2 + 1` åˆ° n çš„èŠ‚ç‚¹éƒ½æ˜¯å¶å­èŠ‚ç‚¹ã€‚

##### å»ºå †çš„æ—¶é—´å¤æ‚åº¦

* æ¯ä¸ªèŠ‚ç‚¹å †åŒ–çš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(logn)`. ä½† `n / 2 + 1` ä¸ªèŠ‚ç‚¹åŠ èµ·æ¥çš„æ—¶é—´å¤æ‚åº¦å¹¶ä¸æ˜¯  `O(nlogn)`ï¼Œè¿™ä¸ªç»“æœå…¶å®ä¸å¤Ÿç²¾ç¡®ã€‚
* å®é™…ä¸Šï¼Œ**å †æ’åºå»ºå †è¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n)`.**
* å¶å­èŠ‚ç‚¹ä¸éœ€è¦å †åŒ–ï¼Œæ‰€ä»¥éœ€è¦å †åŒ–çš„èŠ‚ç‚¹ä»å®Œå…¨äºŒå‰æ ‘çš„å€’æ•°ç¬¬äºŒå±‚å¼€å§‹ã€‚æ¯ä¸ªèŠ‚ç‚¹å †åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ¯”è¾ƒå’Œäº¤æ¢çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œä¸è¿™ä¸ªèŠ‚ç‚¹çš„é«˜åº¦ k æˆæ­£æ¯”ã€‚
* ä¸‹é¢æ˜¯æ¯ä¸€å±‚èŠ‚ç‚¹çš„ä¸ªæ•°å’Œå¯¹åº”çš„é«˜åº¦éƒ½ç”»äº†å‡ºæ¥ï¼Œå¯ä»¥è§‚å¯Ÿå‘ç°ï¼Œåªéœ€è¦å°†æ¯ä¸ªèŠ‚ç‚¹çš„é«˜åº¦æ±‚å’Œï¼Œå¾—å‡ºçš„å°±æ˜¯å»ºå †çš„æ—¶é—´å¤æ‚åº¦ã€‚

![[å»ºå †çš„èŠ‚ç‚¹ç¤ºæ„å›¾.png]]

* æŠŠæ¯ä¸ªéå¶å­èŠ‚ç‚¹çš„é«˜åº¦æ±‚å’Œï¼Œå°±æ˜¯è¿™ä¸ªå…¬å¼:

![[å»ºå †çš„æ—¶é—´å¤æ‚åº¦è®¡ç®—å…¬å¼.png]]

* æ±‚è§£è¿™ä¸ªå…¬å¼çš„æ–¹å¼æ¯”è¾ƒå–å·§ï¼Œåœ¨é«˜ä¸­æ•°å­¦æœ‰å­¦è¿‡ï¼šå°±æ˜¯æŠŠå…¬å¼å·¦å³éƒ½ä¹˜ä»¥ 2ï¼Œå¾—åˆ°å¦ä¸€ä¸ªå…¬å¼ï¼Œå†æŠŠä¸¤ä¸ªå…¬å¼é”™ä½å¯¹é½ï¼Œå¹¶ä¸”ç”¨ S2 å‡å» S1ï¼Œå¯ä»¥å¾—åˆ°ç»“æœ Sã€‚

![[å»ºå †çš„æ—¶é—´å¤æ‚åº¦å…¬å¼æ±‚è§£è¿‡ç¨‹.png]]

* S çš„ä¸­é—´éƒ¨åˆ†æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç­‰æ¯”æ•°åˆ—çš„æ±‚å’Œå…¬å¼æ¥è®¡ç®—ã€‚æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š

![[å»ºå †çš„æ—¶é—´å¤æ‚åº¦è®¡ç®—æœ€ç»ˆå…¬å¼.png]]

* å› ä¸º `h = logâ‚‚n`ï¼Œä»£å…¥å…¬å¼ Sï¼Œå°±èƒ½å¾—åˆ° `S = O(n)`. å› æ­¤ï¼Œå»ºå †çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ `O(n)`.

#### æ’åº

* æˆåŠŸçš„å»ºå †ä¹‹åï¼Œæ•°ç»„ä¸­çš„æ•°æ®åº”å½“æ˜¯æŒ‰ç…§å¤§é¡¶å †çš„ç‰¹æ€§æ¥ç»„ç»‡çš„ã€‚æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å †é¡¶ï¼Œä¹Ÿå°±æ˜¯æœ€å¤§çš„å…ƒç´ ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œä¹Ÿå°±æ˜¯æŠŠæœ€å¤§çš„å…ƒç´ æ”¾åˆ°äº†æœ«å°¾ä¸‹æ ‡ä¸º n çš„ä½ç½®ã€‚
* è¿™ä¸ªè¿‡ç¨‹æœ‰äº›ç±»ä¼¼ä¸Šæ–‡ä¸­çš„åˆ é™¤å †é¡¶å…ƒç´ çš„æ“ä½œï¼Œ**å½“å †é¡¶å…ƒç´ ç§»é™¤ä¹‹åï¼ŒæŠŠä¸‹æ ‡ä¸º n çš„å…ƒç´ æ”¾åˆ°å †é¡¶ï¼Œå†é€šè¿‡å †åŒ–çš„æ–¹æ³•æŠŠå‰©ä¸‹çš„ n - 1 ä¸ªå…ƒç´ é‡æ–°æ„å»ºæˆå †ï¼›å †åŒ–å®Œæˆä¹‹åï¼Œå†å»å †é¡¶çš„å…ƒç´ ï¼Œæ”¾åˆ°ä¸‹æ ‡ä¸º n - 1 çš„ä½ç½®ï¼Œä¸€ç›´é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°å †ä¸­åªå‰©ä¸‹ä¸‹æ ‡ä¸º 1 çš„ä¸€ä¸ªå…ƒç´ ï¼Œæ’åºå°±å®Œæˆäº†ã€‚**

![[å †æ’åºç¤ºæ„å›¾.png]]

#### å †æ’åºçš„å®ç°

* å †æ’åºçš„ TS å®ç°ï¼Œå †åŒ–å’Œå»ºå †å¤ç”¨ä¸Šæ–‡ï¼ˆè‡ªä¸Šå¾€ä¸‹å¼ï¼‰çš„æ–¹æ³•ï¼Œä½†è¦æ³¨æ„æŠŠæ¯”è¾ƒå€¼æ”¹æˆæœ€å¤§å€¼è®©æ•°ç»„æœ‰åºä¸”æ˜¯é¡ºåºçš„ã€‚ä¸‹é¢æ˜¯äº¤æ¢å’Œå †æ’åºçš„å®ç°ã€‚

```typescript
function heapify(arr: number[], heapSize: number, i: number): void {
  let maxIndex = i;

  /* A infinite loop. */
  // eslint-disable-next-line no-constant-condition
  while (true) {
    // ä¸‹é¢ä¸¤ä¸ªåˆ¤æ–­æ‰¾å‡ºå·¦å³å­èŠ‚ç‚¹ä¸­çš„è¾ƒå¤§å€¼ï¼Œå°†å…¶ä¸å½“å‰èŠ‚ç‚¹äº¤æ¢
    if (2 * i <= heapSize && arr[maxIndex] < arr[2 * i]) maxIndex = 2 * i;
    if (2 * i + 1 <= heapSize && arr[maxIndex] < arr[2 * i + 1]) maxIndex = 2 * i + 1;
    // ç›¸ç­‰æ—¶è¯´æ˜å·²ç»å †åŒ–åˆ°äº†æœ€å
    if (maxIndex === i) break;
    swap(arr, i, maxIndex);
    i = maxIndex;
  }
}

/**
 * @description: æ•°ç»„å…ƒç´ çš„äº¤æ¢é€»è¾‘
 * @param {any[]} arr
 * @param {number} i
 * @param {number} j
 * @return {void}
 */
function swap(arr: any[], i: number, j: number): void {
  [arr[j], arr[i]] = [arr[i], arr[j]];
}

/**
 * @description: å †æ’åº
 * 1. å»ºå †ï¼Œä»å°åˆ°å¤§æ’åºï¼Œå»ºç«‹å¤§é¡¶å †
 * 2. ä»æœ€åèŠ‚ç‚¹å¼€å§‹ï¼Œå’Œæ ¹èŠ‚ç‚¹äº¤æ¢
 * 3. äº¤æ¢åå¯¹æ ¹èŠ‚ç‚¹è¿›è¡Œå †åŒ–
 * 4. å †åŒ–åå†æ¬¡äº¤æ¢åˆ°æ ¹èŠ‚ç‚¹ï¼Œå¹¶ç»§ç»­å¯¹æ ¹èŠ‚ç‚¹å †åŒ–
 * @param {number[]} arr
 * @return {number[]}
 */
function heapSort(arr: number[]): number[] {
  let heapSize: number = arr.length - 1;
  buildHeap(arr, heapSize);
  // !ä»åå¾€å‰æ¯”è¾ƒï¼ŒæŠŠå½“å‰éå†çš„èŠ‚ç‚¹å€¼äº¤æ¢åˆ°æ ¹èŠ‚ç‚¹,æŠŠæ ¹èŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯æœ€å¤§å€¼ï¼‰æ”¾åˆ°å½“å‰æ ‘ï¼ˆå­æ ‘ï¼‰çš„æœ«å°¾
  for (let index = arr.length - 1; index > 1; index--) {
    // æŠŠå½“å‰éå†çš„èŠ‚ç‚¹äº¤æ¢åˆ°æ ¹èŠ‚ç‚¹çš„ä½ç½®
    swap(arr, 1, index);
    heapSize--;
    // å¯¹æ ¹èŠ‚ç‚¹è¿›è¡Œå †åŒ–
    heapify(arr, heapSize, 1);
  }
  return arr;
}

// ä½¿ç”¨å †æ’åºï¼Œæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºç©º
const arrs = [undefined, 3, 2, 4, 1, 5, 6];
heapSort(arrs);
console.log(arrs, 'arrs');
```

* è¿™é‡Œçš„æ’åºé»˜è®¤ä¼šå¿½ç•¥æ•°ç»„çš„ç¬¬ä¸€ä½å…ƒç´ ï¼Œå› æ­¤æ¯”è¾ƒæ˜¯ä»ç´¢å¼• 1 å¼€å§‹çš„è€Œä¸æ˜¯ç´¢å¼• 0ï¼›æ›´å…·ä½“çš„å®ç°å¯ä»¥å‚è§[ä»£ç ](https://github.com/kyriejoshua/javascript-datastructure/blob/main/src/Heap/heap.ts)ã€‚
* åŸæ–‡ä¸­å †æ’åºçš„ Java å®ç°å¦‚ä¸‹ã€‚

```java
// nè¡¨ç¤ºæ•°æ®çš„ä¸ªæ•°ï¼Œæ•°ç»„aä¸­çš„æ•°æ®ä»ä¸‹æ ‡1åˆ°nçš„ä½ç½®ã€‚
public static void sort(int[] a, int n) {
  buildHeap(a, n);
  int k = n;
  while (k > 1) {
    swap(a, 1, k);
    --k;
    heapify(a, k, 1);
  }
}
```

#### å †æ’åºçš„æ—¶é—´å¤æ‚åº¦ï¼Œç©ºé—´å¤æ‚åº¦åŠç¨³å®šæ€§åˆ†æ

* å †æ’åºçš„è¿‡ç¨‹åªéœ€è¦æä¸ªåˆ«çš„ä¸´æ—¶å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥å †æ’åºæ˜¯**åŸåœ°æ’åºç®—æ³•**ã€‚
* å †æ’åºåŒ…æ‹¬å»ºå †å’Œæ’åºä¸¤ä¸ªæ“ä½œï¼›
	* å»ºå †è¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n)`ï¼›
	* å †åŒ–çš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(logn)`;
	* ç”±ä¸Šé¢çš„ä»£ç ä¸¤å±‚å¾ªç¯å¯ä»¥å¾—åˆ°å¾ªç¯è¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n) * O(logn)`.
	* å› æ­¤æ’åºè¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogn).
* **å †æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(nlogn)`.**
* **å †æ’åºä¸æ˜¯ç¨³å®šçš„æ’åºç®—æ³•**ï¼Œå› ä¸ºåœ¨æ’åºè¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨æŠŠå †çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹å’Œå †é¡¶å…ƒç´ äº’æ¢çš„æ“ä½œï¼Œå› æ­¤å°±æœ‰å¯èƒ½æ”¹å˜å€¼ç›¸åŒæ•°æ®çš„åŸå§‹ç›¸å¯¹é¡ºåºã€‚

##### å †å­˜å‚¨çš„è¯´æ˜

* è¿™é‡Œè¦å¯¹å‰é¢çš„å†…å®¹åšä¸€ä¸ªè§£é‡Šï¼Œ**å‰æ–‡å‡è®¾å †ä¸­çš„æ•°æ®æ˜¯ä»æ•°ç»„ä¸‹æ ‡ä¸º 1 çš„ä½ç½®å¼€å§‹å­˜å‚¨çš„ã€‚å¦‚æœä» 0 å¼€å§‹å­˜å‚¨ï¼Œå®é™…ä¸Šå¤„ç†æ€è·¯ä¹Ÿå®Œå…¨ä¸€æ ·ã€‚**
	* å¦‚æœèŠ‚ç‚¹çš„ä¸‹æ ‡æ˜¯ iï¼Œå·¦å­èŠ‚ç‚¹çš„ä¸‹æ ‡å°±æ˜¯ `2 * i + 1`ï¼Œå³å­èŠ‚ç‚¹çš„ä¸‹æ ‡å°±æ˜¯ `2 * i + 2`ï¼Œçˆ¶èŠ‚ç‚¹çš„ä¸‹æ ‡å°±æ˜¯ `(i - 1) / 2`.
	* å¦‚ä¸Šæ‰€è¨€ï¼Œ**ä½¿ç”¨ä¸‹æ ‡ä¸º 0 çš„æ–¹å¼å¼€å§‹å­˜å‚¨ï¼Œåœ¨æ¯æ¬¡è®¡ç®—å·¦å­èŠ‚ç‚¹çš„æ—¶å€™ä¼šéœ€è¦å¤šä¸€æ¬¡åŠ æ³•è¿è¡Œ**ã€‚ç›¸å¯¹æ¥è¯´æ˜¯å†…å­˜æ˜¯å¤šè€—è´¹çš„ã€‚

### ä¸ºä½•å®é™…å¼€å‘ä¸­å¿«é€Ÿæ’åºçš„æ€§èƒ½ä¼šæ¯”å †æ’åºæ›´å¥½ï¼Ÿ

* ä½œè€…è§‰å¾—ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤æ–¹é¢åŸå› é€ æˆï¼š
	* å †æ’åºæ•°æ®çš„è®¿é—®çš„æ–¹å¼æ²¡æœ‰å¿«æ’å‹å¥½ï¼›
	* åŒæ ·çš„æ•°æ®ï¼Œæ’åºè¿‡ç¨‹ä¸­ï¼Œå †æ’åºç®—æ³•çš„æ•°æ®äº¤æ¢æ¬¡æ•°å¤šäºå¿«é€Ÿæ’åºã€‚

#### å †æ’åºæ•°æ®çš„è®¿é—®çš„æ–¹å¼æ²¡æœ‰å¿«é€Ÿæ’åºå‹å¥½

* **å¯¹äºå¿«æ’æ¥è¯´ï¼Œæ•°æ®æ˜¯é¡ºåºè®¿é—®çš„ã€‚è€Œå¯¹äºå †æ’åºæ¥è¯´ï¼Œæ•°æ®æ˜¯è·³ç€è®¿é—®çš„ã€‚**
	* ä¾‹å¦‚å †æ’åºä¸­æœ€é‡è¦çš„æ“ä½œä¹‹ä¸€ï¼Œæ•°æ®çš„å †åŒ–ã€‚å¯¹å †é¡¶ç‚¹è¿›è¡Œå †åŒ–ï¼Œä¼šä¾æ¬¡è®¿é—®ä¸‹æ ‡ä¸º 1ï¼Œ2ï¼Œ4ï¼Œ8 çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯åƒå¿«é€Ÿæ’åºä¸€æ ·å±€éƒ¨è®¿é—®ã€‚
	* **è¿™æ ·çš„è®¿é—®å¯¹ CPU ç¼“å­˜æ˜¯ä¸å‹å¥½çš„ã€‚**

![[å †æ’åºä¸‹æ ‡è®¿é—®ç¤ºæ„å›¾.png]]

#### åŒæ ·çš„æ•°æ®ï¼Œæ’åºè¿‡ç¨‹ä¸­ï¼Œå †æ’åºç®—æ³•çš„æ•°æ®äº¤æ¢æ¬¡æ•°å¤šäºå¿«é€Ÿæ’åº

* å‰é¢çš„ç« èŠ‚æåˆ°è¿‡æœ‰åºåº¦å’Œé€†åºåº¦çš„æ¦‚å¿µã€‚**å¯¹äºåŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•æ¥è¯´ï¼Œæ•´ä¸ªæ’åºè¿‡ç¨‹å°±æ˜¯ç”±ä¸¤ä¸ªåŸºæœ¬çš„æ“ä½œç»„æˆçš„â€”â€”æ¯”è¾ƒå’Œäº¤æ¢ï¼ˆç§»åŠ¨ï¼‰ã€‚**
	* å¿«é€Ÿæ’åºæ•°æ®äº¤æ¢çš„æ¬¡æ•°ä¸ä¼šæ¯”é€†åºåº¦å¤šã€‚
	* ç„¶è€Œå †æ’åºçš„ç¬¬ä¸€æ­¥æ˜¯å»ºå †ï¼Œ**å»ºå †çš„è¿‡ç¨‹ä¼šæ‰“ä¹±æ•°æ®åŸæœ‰çš„ç›¸å¯¹å…ˆåé¡ºåºï¼Œå¯¼è‡´åŸæ•°æ®çš„æœ‰åºåº¦é™ä½ã€‚**
		* æ¯”å¦‚ï¼Œä¸€ç»„å·²ç»æœ‰åºçš„æ•°æ®ç»è¿‡å»ºå †ä¹‹åï¼Œ*æ•°æ®åè€Œå˜å¾—æ— åºäº†*ã€‚

![[å †æ’åºå †åŒ–è¿‡ç¨‹ç¤ºæ„å›¾.png]]

* å¯¹äºè¿™ä¸€ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ä»£ç å®è·µã€‚ç”¨ä¸€ä¸ªå˜é‡æ¥è®°å½•äº¤æ¢æ¬¡æ•°ï¼Œæ¯æ¬¡äº¤æ¢ï¼Œå¯¹å˜é‡åŠ ä¸€ï¼Œæ’åºå®Œæˆä¹‹åï¼Œå˜é‡å¤§å°å°±æ˜¯æ€»çš„äº¤æ¢æ¬¡æ•°ã€‚æ¯”è¾ƒä¸¤è€…çš„å˜é‡å¤§å°æ¥éªŒè¯å †æ’åºçš„äº¤æ¢æ˜¯å¦æ¯”å¿«é€Ÿæ’åºäº¤æ¢æ¬¡æ•°æ›´å¤šã€‚
* ä¸‹é¢æˆ‘ä»¬ç”¨å®é™…ä¾‹å­æ¥éªŒè¯ã€‚
* é¦–å…ˆï¼Œç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 20 çš„éšæœºæ’åˆ—çš„æ•°ç»„ã€‚

```typescript
/**
 * @description: ç”Ÿæˆé™åˆ¶æœ€å¤§å€¼å’Œæœ€å°å€¼ä»¥åŠé•¿åº¦çš„éšæœºæ•°çš„æ•°ç»„
 * @param {number} len
 * @param {number} min
 * @param {number} max
 * @return {number[]}
 */
function randomArray(len: number, min: number, max: number): number[] {
  return Array.from({length: len}, () => Math.floor(Math.random()*(max-min)+min));
}
randomArray(20, 1, 20);
```

* åˆ†åˆ«æ‰§è¡Œå †æ’åºå’Œå¿«é€Ÿæ’åºã€‚å¹¶ä¸”åœ¨äº¤æ¢çš„åœ°æ–¹è®°å½•æ¬¡æ•°ã€‚

```typescript
const arr = [18, 3, 7, 14, 19, 8, 1, 15, 4, 16, 17, 10, 5, 2, 6, 13, 12, 11, 9, 20];
let heapSwapCount = 0;

function swap(arr: any[], i: number, j: number): void {
	heapSwapCount++;
  [arr[j], arr[i]] = [arr[i], arr[j]];
}

/**
 * @description: å †æ’åº
 * 1. å»ºå †ï¼Œä»å°åˆ°å¤§æ’åºï¼Œå»ºç«‹å¤§é¡¶å †
 * 2. ä»æœ€åèŠ‚ç‚¹å¼€å§‹ï¼Œå’Œæ ¹èŠ‚ç‚¹äº¤æ¢
 * 3. äº¤æ¢åå¯¹æ ¹èŠ‚ç‚¹è¿›è¡Œå †åŒ–
 * 4. å †åŒ–åå†æ¬¡äº¤æ¢åˆ°æ ¹èŠ‚ç‚¹ï¼Œå¹¶ç»§ç»­å¯¹æ ¹èŠ‚ç‚¹å †åŒ–
 * @param {number[]} arr
 * @return {number[]}
 */
function heapSort(arr: number[]): number[] {
  buildHeap(arr, arr.length - 1);
  let heapSize: number = arr.length - 1;
  for (let index = arr.length - 1; index > 1; index--) {
    // æŠŠå½“å‰éå†çš„èŠ‚ç‚¹äº¤æ¢åˆ°æ ¹èŠ‚ç‚¹çš„ä½ç½®
    swap(arr, 1, index);
    heapSize--;
    // å¯¹æ ¹èŠ‚ç‚¹è¿›è¡Œå †åŒ–
    heapify(arr, heapSize, 1);
  }
  return arr;
}

// ä½¿ç”¨å †æ’åºï¼Œæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºç©º
const arrs = [undefined, 3, 2 , 4, 1, 5, 6];
console.log(heapSort([undefined, ...arr].slice()));
console.log(heapSwapCount); // 65
```

* æ³¨æ„è¿™é‡Œçš„å¿«é€Ÿæ’åºæ˜¯ä½¿ç”¨åŸåœ°æ’åºçš„å®ç°æ–¹å¼ã€‚

```typescript
const arr = [18, 3, 7, 14, 19, 8, 1, 15, 4, 16, 17, 10, 5, 2, 6, 13, 12, 11, 9, 20];
let quickSwapCount = 0;

function partition(arr: number[], start: number, end: number): number {
  const pivotValue = arr[end]; // é»˜è®¤ä»æœ«å°¾å–åˆ†æ”¯ç‚¹
  let pivotIndex = start; // ä»èµ·å§‹ä½ç½®å–ç´¢å¼•

  for (let i = start; i < end; i++) {
    if (arr[i] < pivotValue) {
      quickSwapCount++;
      [arr[i], arr[pivotIndex]] = [arr[pivotIndex], arr[i]];
      pivotIndex++;
    }
  }
  // !æŠŠåˆ†åŒºçš„åŸºå‡†å€¼æ”¾åœ¨ä¸­é—´ï¼Œä½¿å¾—æ•°ç»„å·¦ä¸­å³ä¸‰éƒ¨åˆ†æ•´ä½“ä¸Šæ˜¯æœ‰åºçš„
  [arr[pivotIndex], arr[end]] = [arr[end], arr[pivotIndex]];

  return pivotIndex;
}

function quickSortRecursive(arr: number[], start = 0, end = arr.length - 1): number[] {
  // ç»ˆæ­¢æ¡ä»¶æ˜¯ç´¢å¼•çš„å åŠ 
  if (start >= end) return;

  const index = partition(arr, start, end);
  // æ³¨æ„åˆ†å‰²çš„ç´¢å¼•ä½ç½®ï¼Œåˆ†åˆ«åœ¨åˆ†åŒºç‚¹çš„å‰å
  quickSortRecursive(arr, start, index - 1);
  quickSortRecursive(arr, index + 1, end);

  return arr;
}

console.log(quickSortRecursive(arr));
console.log(quickSwapCount); // 32
```

* ä»è¿™ä¸ªå¯èƒ½å¹¶ä¸ç®—ç»å…¸çš„ä¾‹å­å¯¹æ¯”æ¥çœ‹ï¼ŒåŸåœ°æ’åºçš„å¿«æ’çš„äº¤æ¢æ¬¡æ•°æ¯”å †æ’åºå°‘å¾—æ˜æ˜¾ï¼Œåˆ†åˆ«ä¸º 51 æ¬¡å’Œ 73 æ¬¡ã€‚
* è®©æˆ‘ä»¬æŠŠéšæœºæ•°ç»„çš„é•¿åº¦æ‹‰å¤§åˆ° 100ï¼Œç„¶åç›´æ¥è¿è¡Œå¾—åˆ°ç»“æœã€‚

```typescript
const bigArr = [
  54, 13, 70, 48, 19, 29, 81, 27, 12, 58, 28, 37, 48, 71, 34, 87, 79, 91, 65, 60, 72, 77, 34, 54, 75, 79, 87, 30, 66,
  61, 37, 59, 84, 84, 87, 29, 75, 70, 50, 18, 53, 50, 59, 83, 36, 84, 21, 63, 52, 32, 44, 64, 64, 61, 29, 99, 90, 93,
  37, 19, 81, 95, 45, 48, 56, 23, 39, 68, 21, 63, 33, 91, 23, 73, 54, 92, 89, 35, 44, 68, 15, 71, 6, 49, 59, 49, 44, 66,
  72, 7, 20, 34, 6, 2, 68, 70, 78, 58, 28, 85,
];

console.log(heapSort([undefined, ...bigArr].slice()));
console.log(count); // 582

console.log(quickSortRecursive(bigArr));
console.log(quickSwapCount); // 341
```

* å¯ä»¥çœ‹åˆ°å·®è·ä»ç„¶æ˜¯ååˆ†æ˜¾è‘—çš„ `582-341`ã€‚

## å°ç»“

* å †æ˜¯ä¸€ç§å®Œå…¨äºŒå‰æ ‘ã€‚
* ç‰¹æ€§ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºç­‰äºæˆ–å°äºç­‰äºå…¶å­æ ‘èŠ‚ç‚¹çš„å€¼ï¼Œå †å› æ­¤åˆ†æˆå¤§é¡¶å †å’Œå°é¡¶å †ã€‚
* å †ä¸­æ¯”è¾ƒé‡è¦çš„æ“ä½œæ˜¯æ’å…¥ä¸€ä¸ªæ•°æ®å’Œåˆ é™¤å †é¡¶å…ƒç´ ã€‚è¿™ä¸¤ä¸ªæ“ä½œéƒ½ä¼šç”¨åˆ°å †åŒ–ã€‚
	* æ’å…¥ä¸€ä¸ªæ•°æ®æ—¶ï¼Œæ–°æ’å…¥çš„æ•°æ®å…ˆæ”¾åˆ°æ•°ç»„æœ€åï¼Œç„¶åä»ä¸‹å¾€ä¸Šå †åŒ–ï¼›
	* åˆ é™¤å †é¡¶æ•°æ®çš„æ—¶å€™ï¼ŒæŠŠæ•°ç»„ä¸­æœ€åä¸€ä¸ªå…ƒç´ æ”¾åˆ°å †é¡¶ï¼Œç„¶åä»ä¸Šå¾€ä¸‹å †åŒ–ã€‚
	* è¿™ä¸¤ä¸ªæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ `O(logn)`.
* å †çš„ç»å…¸åº”ç”¨åŒ…æ‹¬å †æ’åºã€‚å †æ’åºåŒ…æ‹¬ä¸¤ä¸ªè¿‡ç¨‹ï¼Œå»ºå †å’Œæ’åºã€‚
	* æŠŠä¸‹æ ‡ n / 2 åˆ° 1 çš„èŠ‚ç‚¹ï¼Œä¾æ¬¡è¿›è¡Œä»ä¸Šåˆ°ä¸‹çš„å †åŒ–ï¼Œç„¶åå°±å¯æŠŠæ•°ç»„ä¸­çš„æ•°æ®ç»„ç»‡æˆå †è¿™ç§æ•°æ®ç»“æ„ã€‚
	* å†è¿­ä»£åœ°æŠŠå †é¡¶å…ƒç´ å’Œå †çš„æœ«å°¾å…ƒç´ è¿›è¡Œäº¤æ¢ï¼Œå †çš„å¤§å°å‡ä¸€ï¼Œå†ä»ä¸Šåˆ°ä¸‹å †åŒ–ï¼Œé‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°å †ä¸­åªå‰©ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè¿™æ—¶å †æ’åºå°±å·²ç»å®Œæˆï¼Œæ•°ç»„å˜æˆæœ‰åºã€‚

## æ‰©å±•

* ä¸ºä½•å®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œä¸‹æ ‡ n / 2 åˆ° n çš„èŠ‚ç‚¹éƒ½æ˜¯å¶å­èŠ‚ç‚¹ï¼Œè¿™æ˜¯å¦‚ä½•æ¨å¯¼çš„ï¼Ÿ
	* ğŸ’­ å¯ä»¥ä½¿ç”¨åè¯æ³•è¯æ˜ã€‚
* å †çš„åº”ç”¨é™¤äº†å †æ’åºè¿˜æœ‰å“ªäº›å†…å®¹ï¼Ÿ
	* è¯¦è§ä¸‹ä¸€ç« èŠ‚ [[Tech/æŠ€æœ¯ç¬”è®°/ã€Šç®—æ³•ä¸æ•°æ®ç»“æ„ã€‹å­¦ä¹ ç¬”è®°/æ•°æ®ç»“æ„ä¹‹å †çš„åº”ç”¨/index|å †çš„åº”ç”¨]]ã€‚

#ALG #ADT 